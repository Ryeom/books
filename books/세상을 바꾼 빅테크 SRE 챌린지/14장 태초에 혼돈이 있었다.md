이번 장은 넷플릭스의 **카오스 엔지니어링** 사례를 통해 현대의 복잡한 시스템에서 어떻게 안정성을 확보하는지에 대해 설명. 엔지니어의 합리적 결정만으로는 예측 불가능한 시스템 전체 장애를 막을 수 없다는 문제를 제기하며, 이를 해결하기 위한 실험적인 접근법인 카오스 엔지니어링의 개념, 원칙, 실제 사례를 소개함.

#### **1. 복잡한 시스템의 문제점**

- **전통적 방법의 한계:** TDD(테스트 주도 개발), 애자일 등 기존 개발 방식은 버그를 줄이는 데 중요하지만, 수백 개의 마이크로서비스가 상호 작용하는 현대 분산 시스템의 가용성을 완벽히 보장하기에는 역부족이다.
- **합리적 결정의 비합리적 결과:** 넷플릭스 사용자의 동시 새로고침 시나리오를 통해, 개별 팀이 합리적 베스트 프랙티스(인메모리 캐시 사용, 오토스케일링 등)를 적용했음에도 시스템 전체가 의도치 않은 연쇄 장애를 일으킬 수 있음을 보여준다.
- **복잡성 탐색의 필요성:** 복잡한 시스템은 어떤 한 부분만으로는 전체를 이해하고 예측할 수 없으므로, 복잡성을 줄이기보다는 복잡성 자체를 다루는 새로운 방법이 필요하다.

#### **2. 카오스 엔지니어링의 탄생**

- **복잡성 경제 원칙:** 시스템의 네 가지 복잡성 원칙(상태, 관계, 환경, 비가역성) 중, 소프트웨어 시스템에서는 **비가역성**을 최적화하는 것이 중요하다고 말한다.
- **카오스 몽키(Chaos Monkey):** 넷플릭스가 클라우드 전환 후 인스턴스가 실패할 가능성이 커지자, 엔지니어들에게 **안전성 신호**를 주기 위해 개발한 도구이다. 업무 시간에 무작위로 인스턴스를 종료시켜 예상치 못한 장애에 대비하도록 훈련시킨다.
- **카오스 콩(Chaos Kong):** 카오스 몽키의 확장 버전으로, 인스턴스 수준을 넘어 **전체 리전**을 종료시키는 대규모 실험을 통해 시스템의 복원력을 테스트한다.

#### **3. 카오스 엔지니어링의 원칙과 방법**

- **공식화된 정의:** "시스템의 약점을 발견하기 위해 실험을 촉진하는 것"으로 정의된다.
- **실험 템플릿 4단계:**
    1. **정상 상태(steady state) 정의:** 시스템의 정상적인 작동 상태를 측정 가능한 출력으로 정의한다.
    2. **가설 설정:** 정상 상태가 대조군과 실험군 모두에서 지속될 것이라고 가정한다.
    3. **변수 도입:** 서버 고장, 네트워크 끊김 등 실제 장애를 반영하는 변수를 실험군에 주입한다.
    4. **가설 반증:** 대조군과 실험군 사이의 정상 상태 차이를 관찰하여 가설이 틀렸음을 입증한다.
- **고급 원칙:** 프로덕션 환경에서 실험을 실행하고, 이를 지속적으로 자동화하며, 장애 영향 범위를 최소화하는 것이 중요하다.

### **결론**

카오스 엔지니어링은 시스템에 혼란을 일으키는 것이 아니라, 시스템에 **내재된 혼란을 드러내는 도구**이다. SRE와 함께 복잡한 시스템의 신뢰성을 높이는 데 필수적인 실무 관행이다.

---
## 주요 용어 정리

- **카오스 엔지니어링(Chaos Engineering):** 시스템에 내재된 혼돈과 약점을 파악하기 위해, **의도적으로 시스템에 장애를 주입하는 실험적인 방법론**이다. 장애가 발생했을 때 시스템이 어떻게 반응하고 복구하는지 실제 프로덕션 환경에서 검증하여 신뢰성을 높인다.
- **카오스 몽키(Chaos Monkey):** 넷플릭스가 개발한 카오스 엔지니어링 도구. 운영 시간 중에 무작위로 서버 인스턴스를 종료시켜, 엔지니어들이 예상치 못한 장애에 대비하도록 훈련시킨다.
- **카오스 콩(Chaos Kong):** 카오스 몽키의 확장 버전. 인스턴스 수준을 넘어 **데이터 센터나 전체 리전(region)을 강제로 종료**시키는 대규모 실험을 통해 시스템의 복원력을 테스트한다.
- **복잡성의 경제적 원칙(Economic Pillars of Complexity):** 켄트 벡이 제시한 모델로, 시스템을 혼란스럽게 만드는 네 가지 원칙(상태, 관계, 환경, 비가역성)을 식별하여 복잡성을 관리하는 데 도움을 준다.
- **정상 상태(Steady State):** 시스템이 정상적으로 작동하는 상태. 카오스 엔지니어링 실험의 출발점이 되며, 실험 전후의 상태를 비교하여 시스템의 변화를 측정한다.
- **SPOF (Single Point of Failure):** 단일 장애 지점. 시스템의 한 부분이 고장 나면 전체 시스템이 멈추는 취약점을 뜻한다. 카오스 엔지니어링은 이러한 SPOF를 찾아내고 제거하는 데 중요한 역할을 한다.
- **비가역성(Irreversibility):** 시스템 변경이 얼마나 쉽게 취소될 수 있는지를 나타내는 원칙. 마이크로서비스와 CI/CD는 변경의 **가역성**을 높여 시스템의 복잡성에 유연하게 대응할 수 있도록 돕는다.
