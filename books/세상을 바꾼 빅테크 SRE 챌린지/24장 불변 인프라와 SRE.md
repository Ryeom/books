**불변 인프라(Immutable Infrastructure)**는 서버의 구성을 수동으로 변경하는 대신, 새로운 서버 이미지로 완전히 **교체**하는 방식이다. 이는 SRE의 핵심 목표인 **노동(Toil)을 극적으로 줄이고, 시스템의 신뢰성, 보안, 그리고 확장성**을 규모에 맞게 향상시키는 가장 강력한 프랙티스이다.

#### **1. 핵심 장점 및 SRE 기여**

- **노동 감소 및 확장성:** 수동 설정 관리(Chef, Puppet 등)의 복잡성과 오류 가능성을 제거하고, 서버를 '애완동물'이 아닌 '가축'처럼 관리한다. 1,000대 이상의 노드에 대한 수동 관리에 드는 노동을 절감함.
- **신속한 복구 및 운영 간소화:** 장애 발생 시 노드를 신속하게 신규 이미지로 교체(몇 분 이내)하여 복원력을 극대화하며, 복잡한 '상태 전환'을 관리할 필요 없이 단순하고 일관된 운영이 가능하다.
- **시스템 상태의 명확성 확보 (보안 강화):** 인스턴스가 단기간(며칠 미만)만 실행되므로, 오랜 기간 누적된 알려지지 않은 설정 오류나 악성코드가 존재할 위험이 사라진다. 이는 보안 및 SRE 관점에서 시스템의 **'알려진 현재 상황'**을 보장한다.
- **신뢰할 수 있는 CI/CD:** Dev, Test, Prod 환경에서 **정확히 동일한 이미지**를 사용함으로써 "테스트에서는 잘 작동했어요"와 같은 환경 불일치 문제를 근본적으로 해소함.
- **안전한 배포 및 멀티 리전:** **블루/그린 배포**를 통해 빠르고 유연한 롤아웃과 롤백이 가능하며, 단일 이미지를 복사하여 배포함으로써 복잡한 설정 동기화 없이 **멀티 리전 운영**을 단순화한다.

#### **2. 구현 방법 및 트레이드오프**

- **구현 프로세스:** 기본 이미지 구축 (최적화, 보안 패치) → 애플리케이션 패키징 → 테스트 및 **카나리** 배포 → **블루/그린 배포**로 최종 전환의 과정을 거친다.
- **단점 (트레이드오프):**
    - **영구 데이터 계층:** Cassandra 같은 일부 DB 외에는 불변 인프라 적용이 어렵거나 **롤링 배포** 방식을 사용해야 한다.
    - **반복 대기 시간 증가:** 새로운 이미지를 빌드하는 시간이 길어, 개발자의 **반복 대기 시간(Iteration Latency)**이 늘어나 생산성이 저하될 수 있다. 이는 개발 워크스테이션에서 임시 서버로의 쉬운 동기화 등으로 완화함이 필요하다.

---

## 주요 용어 정리

- **불변 인프라 (Immutable Infrastructure):** 서버의 운영 중 설정을 변경하지 않고, 변경이 필요하면 새로운 구성이 적용된 이미지로 기존 인스턴스를 통째로 교체하는 인프라 관리 방식이다.
- **노동 (Toil):** 수동적이고, 반복적이며, 자동화할 수 있는, 부가 가치가 낮은 운영 업무를 말함.
- **블루/그린 배포 (Blue/Green Deployment):** 현재 서비스 중인 환경(Blue)과 신규 버전 환경(Green)을 동시에 운영하며 트래픽을 전환하는 방식이다. 불변 인프라의 주요 배포 전략이다.
- **반복 대기 시간 (Iteration Latency):** 개발자가 코드를 수정하고 결과를 다시 확인하기까지 걸리는 시간이다. 불변 인프라의 새로운 이미지 빌드 때문에 이 시간이 늘어날 수 있다.
- **설정 관리 툴 (Configuration Management Tools):** (예: Puppet, Chef) 서버의 설정을 코드로 관리하던 기존 방식이다. 불변 인프라에서는 이미지 빌드 단계에서만 사용되고 런타임에는 사용되지 않는다.
- **롤링 배포 (Rolling Deployment):** 클러스터 내의 노드를 한 번에 하나씩 또는 작은 그룹으로 순차적으로 교체하는 배포 방식이다. 데이터 계층처럼 불변 인프라 적용이 어려운 환경에서 주로 사용된다.